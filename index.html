<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Reverse-Engineer - Extract Chart Data to Excel</title>
    <meta name="description" content="Automatically extract data from chart images (pie, bar, column, tables) and convert to Excel workbooks">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìä</text></svg>">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes pulse-soft {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        .animate-pulse-soft {
            animation: pulse-soft 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // SVG Icons
        const Upload = ({ className = "w-6 h-6" }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="17 8 12 3 7 8"/>
                <line x1="12" y1="3" x2="12" y2="15"/>
            </svg>
        );

        const FileSpreadsheet = ({ className = "w-6 h-6" }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
                <polyline points="14 2 14 8 20 8"/>
                <path d="M8 13h2"/>
                <path d="M8 17h2"/>
                <path d="M14 13h2"/>
                <path d="M14 17h2"/>
            </svg>
        );

        const Loader2 = ({ className = "w-6 h-6" }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 12a9 9 0 1 1-6.219-8.56"/>
            </svg>
        );

        const CheckCircle = ({ className = "w-6 h-6" }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                <polyline points="22 4 12 14.01 9 11.01"/>
            </svg>
        );

        const AlertCircle = ({ className = "w-6 h-6" }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" y1="8" x2="12" y2="12"/>
                <line x1="12" y1="16" x2="12.01" y2="16"/>
            </svg>
        );

        const Github = ({ className = "w-6 h-6" }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"/>
                <path d="M9 18c-4.51 2-5-2-7-2"/>
            </svg>
        );

        const BarChart = ({ className = "w-6 h-6" }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="12" y1="20" x2="12" y2="10"/>
                <line x1="18" y1="20" x2="18" y2="4"/>
                <line x1="6" y1="20" x2="6" y2="16"/>
            </svg>
        );

        const PieChart = ({ className = "w-6 h-6" }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21.21 15.89A10 10 0 1 1 8 2.83"/>
                <path d="M22 12A10 10 0 0 0 12 2v10z"/>
            </svg>
        );

        const Table = ({ className = "w-6 h-6" }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                <line x1="3" y1="9" x2="21" y2="9"/>
                <line x1="3" y1="15" x2="21" y2="15"/>
                <line x1="12" y1="3" x2="12" y2="21"/>
            </svg>
        
        // Anthropic API configuration. Insert your API key here. Without a valid key,
        // the extract function will not call the service and will instead prompt the user.
        const ANTHROPIC_API_KEY = '';
        const ANTHROPIC_VERSION = '2023-06-01';
);

        function ExcelReverseEngineer() {
            const [file, setFile] = useState(null);
            const [preview, setPreview] = useState(null);
            const [status, setStatus] = useState('idle');
            const [message, setMessage] = useState('');
            const [extractedData, setExtractedData] = useState(null);
            const [stats, setStats] = useState({ total: 0, success: 0 });

            useEffect(() => {
                const saved = localStorage.getItem('extraction-stats');
                if (saved) {
                    setStats(JSON.parse(saved));
                }
            }, []);

            const updateStats = (success) => {
                const newStats = {
                    total: stats.total + 1,
                    success: stats.success + (success ? 1 : 0)
                };
                setStats(newStats);
                localStorage.setItem('extraction-stats', JSON.stringify(newStats));
            };

            const handleFileSelect = (e) => {
                const selectedFile = e.target.files?.[0];
                if (selectedFile && selectedFile.type === 'image/png') {
                    setFile(selectedFile);
                    setStatus('idle');
                    setMessage('');
                    setExtractedData(null);
                    
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        setPreview(event.target.result);
                    };
                    reader.readAsDataURL(selectedFile);
                } else {
                    setMessage('Please select a PNG image file');
                    setStatus('error');
                }
            };

            const handleDrop = (e) => {
                e.preventDefault();
                const droppedFile = e.dataTransfer.files[0];
                if (droppedFile && droppedFile.type === 'image/png') {
                    setFile(droppedFile);
                    setStatus('idle');
                    setMessage('');
                    setExtractedData(null);
                    
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        setPreview(event.target.result);
                    };
                    reader.readAsDataURL(droppedFile);
                }
            };

            const handleDragOver = (e) => {
                e.preventDefault();
            };

            const sleep = (ms) => new Promise(resolve => setTimeout(resolve, ms));

            const extractDataFromImage = async (retryCount = 0) => {
                if (!file) return;
                        // Require an API key before making requests
        if (!ANTHROPIC_API_KEY) {
            setStatus('error');
            setMessage('Missing Anthropic API key. Please add your API key to the code to enable extraction.');
            updateStats(false);
            return;
        }


                setStatus('processing');
                setMessage(retryCount > 0 ? `Retrying... (attempt ${retryCount + 1}/3)` : 'Analyzing image with AI...');

                try {
                    const base64Data = await new Promise((resolve, reject) => {
                        const reader = new FileReader();
                        reader.onload = () => resolve(reader.result.split(',')[1]);
                        reader.onerror = reject;
                        reader.readAsDataURL(file);
                    });

                    const response = await fetch('https://api.anthropic.com/v1/messages', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                                        'x-api-key': ANTHROPIC_API_KEY,
            'anthropic-version': ANTHROPIC_VERSION,

                        },
                        body: JSON.stringify({
                                
            

                            model: 'claude-sonnet-4-20250514',
                            max_tokens: 4000,
                            messages: [
                                {
                                    role: 'user',
                                    content: [
                                        {
                                            type: 'image',
                                            source: {
                                                type: 'base64',
                                                media_type: 'image/png',
                                                data: base64Data
                                            }
                                        },
                                        {
                                            type: 'text',
                                            text: `EXTRACT EVERY SINGLE NUMBER FROM THIS IMAGE. DO NOT SUMMARIZE. DO NOT DESCRIBE. EXTRACT ACTUAL VALUES.

YOU MUST:
1. Read EVERY label on EVERY chart/table
2. Read EVERY numeric value shown
3. Measure bar heights against the Y-axis scale
4. Read percentages from pie slices
5. Extract every cell from tables
6. List EVERY data point as a separate row

EXAMPLE OF CORRECT EXTRACTION:
If image shows a bar chart with "Sales Q1: $50K, Q2: $75K, Q3: $60K", you MUST output:
{"label": "Sales Q1", "value": 50000}
{"label": "Sales Q2", "value": 75000}
{"label": "Sales Q3", "value": 60000}

EXAMPLE OF WRONG EXTRACTION (DO NOT DO THIS):
"Notes: All values appear to be around 50K-75K based on chart scale" ‚ùå WRONG

IF IMAGE HAS MULTIPLE CHARTS:
- Extract data from ALL charts
- Create separate entries for each chart's data
- Use descriptive labels like "Pie Chart - Category A: 25%", "Bar Chart 2023: 150"

FOR PIE CHARTS:
- Read the percentage or value shown on EACH slice
- Create one data row per slice
- Example: {"label": "Product A", "value": 35} means 35%

FOR BAR/COLUMN CHARTS:
- Read the Y-axis scale (0, 50, 100, 150, etc.)
- Measure where each bar reaches
- Create one data row per bar
- Example: If bar for "2023" reaches 150 on Y-axis: {"label": "2023", "value": 150}

FOR TABLES:
- Extract EVERY cell
- Create one row per table row
- Use format: {"label": "Row1_Column1", "value": 123}

CRITICAL: If you cannot read a specific number clearly, estimate it based on grid lines/scale and note the estimate. NEVER say "appears to be" without giving the actual number.

Respond ONLY with valid JSON (no markdown, no preamble):
{
  "chartType": "pie|bar|column|table|multiple",
  "title": "exact chart title",
  "data": [
    {"label": "Exact label from chart 1 - Item A", "value": 123.45},
    {"label": "Exact label from chart 1 - Item B", "value": 678.90},
    {"label": "Exact label from chart 2 - 2023", "value": 500},
    {"label": "Exact label from chart 2 - 2024", "value": 650}
  ],
  "metadata": {
    "units": "list units for each chart if different",
    "notes": "only mention if values were estimated due to image quality"
  }
}`
                                        }
                                    ]
                                }
                            ]
                        })
                    });

                    const data = await response.json();
                    
                    if (!response.ok) {
                        if (data.type === 'exceeded_limit' && data.representativeClaim === 'concurrents' && retryCount < 2) {
                            setMessage(`Server busy, waiting 3 seconds before retry ${retryCount + 2}/3...`);
                            await sleep(3000);
                            return extractDataFromImage(retryCount + 1);
                        }
                        
                        const errorMsg = data.type === 'exceeded_limit' 
                            ? 'Too many concurrent requests. Please wait a moment and try again.'
                            : data.error?.message || 'API request failed';
                        throw new Error(errorMsg);
                    }

                    const textContent = data.content
                        .filter(block => block.type === 'text')
                        .map(block => block.text)
                        .join('\n');

                    const cleanJson = textContent.replace(/```json\n?/g, '').replace(/```\n?/g, '').trim();
                    const parsedData = JSON.parse(cleanJson);

                    setExtractedData(parsedData);
                    setStatus('success');
                    setMessage('Data extracted successfully! Click "Generate Excel" to download.');
                    updateStats(true);

                } catch (error) {
                    console.error('Extraction error:', error);
                    setStatus('error');
                    setMessage(`Error: ${error.message}`);
                    updateStats(false);
                }
            };

            const generateExcel = () => {
                if (!extractedData) return;

                try {
                    const wb = XLSX.utils.book_new();

                    const dataSheet = [];
                    
                    if (extractedData.title) {
                        dataSheet.push(['Chart Title:', extractedData.title]);
                        dataSheet.push([]);
                    }

                    dataSheet.push(['Label', 'Value']);

                    extractedData.data.forEach(item => {
                        dataSheet.push([item.label, item.value]);
                    });

                    if (extractedData.metadata) {
                        dataSheet.push([]);
                        dataSheet.push(['Metadata']);
                        if (extractedData.metadata.units) {
                            dataSheet.push(['Units:', extractedData.metadata.units]);
                        }
                        if (extractedData.metadata.notes) {
                            dataSheet.push(['Notes:', extractedData.metadata.notes]);
                        }
                    }

                    const ws = XLSX.utils.aoa_to_sheet(dataSheet);
                    ws['!cols'] = [{ wch: 30 }, { wch: 20 }];
                    XLSX.utils.book_append_sheet(wb, ws, 'Data');

                    const summaryData = [
                        ['Excel Reverse-Engineer Report'],
                        [],
                        ['Chart Type:', extractedData.chartType.toUpperCase()],
                        ['Extracted Date:', new Date().toLocaleString()],
                        ['Total Data Points:', extractedData.data.length],
                        [],
                        ['Source File:', file.name],
                        ['File Size:', `${(file.size / 1024).toFixed(2)} KB`]
                    ];

                    if (extractedData.chartType === 'pie') {
                        const total = extractedData.data.reduce((sum, item) => sum + (item.value || 0), 0);
                        summaryData.push(['Total Sum:', total.toFixed(2)]);
                    }

                    const summaryWs = XLSX.utils.aoa_to_sheet(summaryData);
                    summaryWs['!cols'] = [{ wch: 20 }, { wch: 30 }];
                    XLSX.utils.book_append_sheet(wb, summaryWs, 'Summary');

                    const fileName = `${file.name.replace('.png', '')}_data.xlsx`;
                    XLSX.writeFile(wb, fileName);

                    setMessage('Excel file downloaded successfully!');
                } catch (error) {
                    console.error('Excel generation error:', error);
                    setStatus('error');
                    setMessage(`Error generating Excel: ${error.message}`);
                }
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50">
                    {/* Header */}
                    <header className="bg-white shadow-sm border-b border-gray-200">
                        <div className="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
                            <div className="flex items-center gap-3">
                                <FileSpreadsheet className="w-8 h-8 text-indigo-600" />
                                <div>
                                    <h1 className="text-2xl font-bold text-gray-900">Excel Reverse-Engineer</h1>
                                    <p className="text-sm text-gray-600">AI-Powered Chart Data Extraction</p>
                                </div>
                            </div>
                            <a 
                                href="https://github.com/Jaspersunnyson/excel-reverse-engineer" 
                                target="_blank"
                                rel="noopener noreferrer"
                                className="flex items-center gap-2 px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors"
                            >
                                <Github className="w-5 h-5" />
                                <span className="hidden sm:inline">Star on GitHub</span>
                            </a>
                        </div>
                    </header>

                    <main className="max-w-6xl mx-auto px-4 py-8">
                        {/* Stats Bar */}
                        {stats.total > 0 && (
                            <div className="bg-white rounded-lg shadow-sm p-4 mb-6 flex items-center justify-between">
                                <div className="flex gap-6">
                                    <div>
                                        <p className="text-sm text-gray-600">Total Extractions</p>
                                        <p className="text-2xl font-bold text-indigo-600">{stats.total}</p>
                                    </div>
                                    <div>
                                        <p className="text-sm text-gray-600">Success Rate</p>
                                        <p className="text-2xl font-bold text-green-600">
                                            {stats.total > 0 ? Math.round((stats.success / stats.total) * 100) : 0}%
                                        </p>
                                    </div>
                                </div>
                                <div className="text-sm text-gray-500">
                                    Stored locally in your browser
                                </div>
                            </div>
                        )}

                        {/* Features */}
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
                            <div className="bg-white rounded-lg shadow-sm p-6 text-center">
                                <BarChart className="w-12 h-12 text-blue-600 mx-auto mb-3" />
                                <h3 className="font-semibold text-gray-900 mb-2">Bar Charts</h3>
                                <p className="text-sm text-gray-600">Extract exact values from column and bar charts</p>
                            </div>
                            <div className="bg-white rounded-lg shadow-sm p-6 text-center">
                                <PieChart className="w-12 h-12 text-purple-600 mx-auto mb-3" />
                                <h3 className="font-semibold text-gray-900 mb-2">Pie Charts</h3>
                                <p className="text-sm text-gray-600">Read percentages and values from pie slices</p>
                            </div>
                            <div className="bg-white rounded-lg shadow-sm p-6 text-center">
                                <Table className="w-12 h-12 text-green-600 mx-auto mb-3" />
                                <h3 className="font-semibold text-gray-900 mb-2">Tables</h3>
                                <p className="text-sm text-gray-600">Extract structured data from table images</p>
                            </div>
                        </div>

                        {/* Upload Area */}
                        <div className="bg-white rounded-xl shadow-lg p-8 mb-6">
                            <div
                                onDrop={handleDrop}
                                onDragOver={handleDragOver}
                                className="border-2 border-dashed border-indigo-300 rounded-xl p-12 text-center hover:border-indigo-500 hover:bg-indigo-50/50 transition-all cursor-pointer"
                            >
                                <input
                                    type="file"
                                    accept="image/png"
                                    onChange={handleFileSelect}
                                    className="hidden"
                                    id="file-upload"
                                />
                                <label htmlFor="file-upload" className="cursor-pointer">
                                    <Upload className="w-16 h-16 text-indigo-400 mx-auto mb-4" />
                                    <p className="text-xl font-semibold text-gray-700 mb-2">
                                        Drop PNG image here or click to upload
                                    </p>
                                    <p className="text-gray-500">
                                        Supports pie charts, bar charts, column charts, and tables
                                    </p>
                                    <p className="text-sm text-gray-400 mt-2">
                                        Maximum file size: 10MB
                                    </p>
                                </label>
                            </div>

                            {preview && (
                                <div className="mt-6">
                                    <h3 className="text-lg font-semibold text-gray-700 mb-3">Preview:</h3>
                                    <div className="border-2 border-gray-200 rounded-lg overflow-hidden">
                                        <img
                                            src={preview}
                                            alt="Preview"
                                            className="max-w-full h-auto mx-auto"
                                            style={{ maxHeight: '500px' }}
                                        />
                                    </div>
                                    <div className="mt-2 text-sm text-gray-500">
                                        File: {file.name} ({(file.size / 1024).toFixed(2)} KB)
                                    </div>
                                </div>
                            )}
                        </div>

                        {/* Action Buttons */}
                        {file && (
                            <div className="bg-white rounded-xl shadow-lg p-6 mb-6">
                                <div className="flex flex-col sm:flex-row gap-4">
                                    <button
                                        onClick={extractDataFromImage}
                                        disabled={status === 'processing'}
                                        className="flex-1 bg-indigo-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-indigo-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2"
                                    >
                                        {status === 'processing' ? (
                                            <>
                                                <Loader2 className="w-5 h-5 animate-spin" />
                                                Processing...
                                            </>
                                        ) : (
                                            <>
                                                <Upload className="w-5 h-5" />
                                                Extract Data with AI
                                            </>
                                        )}
                                    </button>

                                    {extractedData && (
                                        <button
                                            onClick={generateExcel}
                                            className="flex-1 bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition-colors flex items-center justify-center gap-2"
                                        >
                                            <FileSpreadsheet className="w-5 h-5" />
                                            Generate Excel File
                                        </button>
                                    )}
                                </div>
                            </div>
                        )}

                        {/* Status Messages */}
                        {message && (
                            <div className={`rounded-lg p-4 mb-6 flex items-start gap-3 ${
                                status === 'error' ? 'bg-red-50 border border-red-200' :
                                status === 'success' ? 'bg-green-50 border border-green-200' :
                                'bg-blue-50 border border-blue-200'
                            }`}>
                                <div className={`flex-shrink-0 mt-0.5 ${
                                    status === 'processing' ? 'animate-spin' : ''
                                }`}>
                                    {status === 'error' && <AlertCircle className="w-5 h-5 text-red-600" />}
                                    {status === 'success' && <CheckCircle className="w-5 h-5 text-green-600" />}
                                    {status === 'processing' && <Loader2 className="w-5 h-5 text-blue-600" />}
                                </div>
                                <p className={`${
                                    status === 'error' ? 'text-red-700' :
                                    status === 'success' ? 'text-green-700' :
                                    'text-blue-700'
                                }`}>
                                    {message}
                                </p>
                            </div>
                        )}

                        {/* Extracted Data Preview */}
                        {extractedData && (
                            <div className="bg-white rounded-xl shadow-lg p-6 mb-8">
                                <h3 className="text-2xl font-semibold text-gray-800 mb-4">Extracted Data Preview</h3>
                                
                                <div className="mb-6 p-4 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg">
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <div>
                                            <p className="text-sm text-gray-600 font-medium">Chart Type</p>
                                            <p className="text-lg font-bold text-gray-900">{extractedData.chartType.toUpperCase()}</p>
                                        </div>
                                        {extractedData.title && (
                                            <div>
                                                <p className="text-sm text-gray-600 font-medium">Title</p>
                                                <p className="text-lg font-bold text-gray-900">{extractedData.title}</p>
                                            </div>
                                        )}
                                        <div>
                                            <p className="text-sm text-gray-600 font-medium">Data Points</p>
                                            <p className="text-lg font-bold text-gray-900">{extractedData.data.length}</p>
                                        </div>
                                    </div>
                                    {extractedData.metadata?.units && (
                                        <div className="mt-3">
                                            <p className="text-sm text-gray-600 font-medium">Units</p>
                                            <p className="text-gray-900">{extractedData.metadata.units}</p>
                                        </div>
                                    )}
                                </div>

                                <div className="overflow-x-auto">
                                    <table className="w-full border-collapse">
                                        <thead>
                                            <tr className="bg-indigo-600 text-white">
                                                <th className="border border-indigo-700 px-4 py-3 text-left font-semibold">Label</th>
                                                <th className="border border-indigo-700 px-4 py-3 text-left font-semibold">Value</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {extractedData.data.map((item, index) => (
                                                <tr key={index} className={index % 2 === 0 ? 'bg-gray-50' : 'bg-white'}>
                                                    <td className="border border-gray-200 px-4 py-2">{item.label}</td>
                                                    <td className="border border-gray-200 px-4 py-2 font-mono">{item.value}</td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>

                                {extractedData.metadata?.notes && (
                                    <div className="mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
                                        <p className="text-sm text-yellow-800">
                                            <strong>üìù Notes:</strong> {extractedData.metadata.notes}
                                        </p>
                                    </div>
                                )}
                            </div>
                        )}

                        {/* Instructions */}
                        <div className="bg-white rounded-xl shadow-lg p-6">
                            <h3 className="text-xl font-semibold text-gray-800 mb-4">How to Use</h3>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h4 className="font-semibold text-gray-700 mb-3">Quick Start</h4>
                                    <ol className="list-decimal list-inside space-y-2 text-gray-600">
                                        <li>Upload a PNG image containing charts or tables</li>
                                        <li>Click "Extract Data with AI" to analyze</li>
                                        <li>Review the extracted data in the preview</li>
                                        <li>Click "Generate Excel File" to download</li>
                                    </ol>
                                </div>
                                <div>
                                    <h4 className="font-semibold text-gray-700 mb-3">Pro Tips</h4>
                                    <ul className="space-y-2 text-gray-600">
                                        <li>‚úì Use high-resolution images for best accuracy</li>
                                        <li>‚úì Ensure labels and values are clearly visible</li>
                                        <li>‚úì Works with multiple charts in one image</li>
                                        <li>‚úì Supports various chart types simultaneously</li>
                                    </ul>
                                </div>
                            </div>
                            <div className="mt-6 p-4 bg-indigo-50 border border-indigo-200 rounded-lg">
                                <p className="text-sm text-indigo-900">
                                    <strong>üîí Privacy:</strong> All processing happens securely. Images are sent to Claude AI for extraction only and are never stored.
                                </p>
                            </div>
                        </div>
                    </main>

                    {/* Footer */}
                    <footer className="bg-white border-t border-gray-200 mt-12">
                        <div className="max-w-6xl mx-auto px-4 py-6 text-center text-gray-600 text-sm">
                            <p>Powered by <strong>Claude AI</strong> ‚Ä¢ Built for GitHub Pages</p>
                            <p className="mt-2">
                                <a href="https://github.com/Jaspersunnyson/excel-reverse-engineer" className="text-indigo-600 hover:underline">View on GitHub</a>
                                {' ‚Ä¢ '}
                                <a href="https://github.com/Jaspersunnyson/excel-reverse-engineer/issues" className="text-indigo-600 hover:underline">Report Issues</a>
                            </p>
                        </div>
                    </footer>
                </div>
            );
        }

        ReactDOM.render(<ExcelReverseEngineer />, document.getElementById('root'));
    </script>
</body>
</html>
